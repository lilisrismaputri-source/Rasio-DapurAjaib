<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resep Ajaib Koki Cilik</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #f0e68c, #ffebcd);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #4a4a4a;
        }

        .game-container {
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px 40px;
            text-align: center;
            width: 90%;
            max-width: 600px;
        }

        h1, h2 {
            color: #d2691e;
        }

        .level-info, .score-info {
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .question-box {
            background-color: #ffe4b5;
            border: 2px solid #d2691e;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .answer-input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        
        #single-answer-input {
            border: 2px solid #d2691e;
            border-radius: 10px;
            padding: 10px;
            font-size: 1em;
            text-align: center;
            width: 150px;
        }

        .answer-input-group input {
            border: 2px solid #d2691e;
            border-radius: 10px;
            padding: 10px;
            font-size: 1em;
            text-align: center;
            width: 80px;
        }

        button {
            background-color: #d2691e;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 12px 25px;
            font-size: 1em;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-3px);
            background-color: #e67e22;
        }

        .feedback {
            margin-top: 15px;
            font-weight: bold;
            min-height: 20px;
        }

        .feedback.correct {
            color: #28a745;
        }

        .feedback.incorrect {
            color: #dc3545;
        }

        .intro-screen, .end-screen, .student-name-form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div id="intro-screen">
            <h1>üßë‚Äçüç≥ Resep Ajaib Koki Cilik üßë‚Äçüç≥</h1>
            <p>Halo, koki cilik! Selamat datang di dapur ajaib. Di sini, kamu akan belajar cara membuat resep yang lezat dengan takaran yang tepat menggunakan **rasio**.</p>
            <p>Rasio adalah perbandingan yang membantu kita mengetahui seberapa banyak bahan yang dibutuhkan satu sama lain. Sama seperti resep kue yang harus tepat takarannya, kamu juga akan belajar membuat perbandingan yang benar.</p>
            <p>Siap untuk petualangan ini?</p>
            <div class="student-name-form">
                <p>Siapa nama kamu?</p>
                <input type="text" id="student-name-input" placeholder="Nama lengkap">
                <button onclick="startGame()">Mulai Petualangan!</button>
            </div>
        </div>
        
        <div id="game-screen" style="display: none;">
            <div class="level-info">
                <h2></h2>
                <p></p>
            </div>
            <div class="score-info">
                Skor: <span id="score">0</span> / 100
            </div>
            <div class="question-box">
                <p id="question-text"></p>
                <div id="input-area">
                    <div id="ratio-input-group" class="answer-input-group" style="display: none;">
                        <input type="text" id="answer-input-1" placeholder="Angka 1">
                        :
                        <input type="text" id="answer-input-2" placeholder="Angka 2">
                    </div>
                    <input type="text" id="single-answer-input" placeholder="Jawaban" style="display: none;">
                    <button id="submit-btn" onclick="checkAnswer()">Jawab!</button>
                </div>
                <div id="feedback-text" class="feedback"></div>
                <button id="next-btn" style="display: none;" onclick="nextQuestion()">Soal Selanjutnya</button>
            </div>
        </div>

        <div id="end-screen" style="display: none;">
            <h1>üéâ Permainan Selesai! üéâ</h1>
            <p>Selamat, <span id="student-name-final"></span>!</p>
            <p>Kamu telah menyelesaikan semua level dengan total skor: <span id="final-score">0</span></p>
            <button onclick="resetGame()">Main Lagi!</button>
        </div>
    </div>
    <script>
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwhKGpQQ3KnRt7fJesbfWyWynKSMRTrjQSgQ1h8KfS90RyHWbY-vNIKKVTaF1zPOMtz/exec';
        let studentName = "";
        
        const questions = {
            level1: [
                { q: "Untuk membuat jus stroberi, Koki Cilik menggunakan üçì 4 buah stroberi dan üçé 8 buah apel. Berapa rasio stroberi terhadap apel?", a: "4:8" },
                { q: "Koki Cilik membuat adonan pizza. Dia menggunakan üçö 3 sendok tepung dan üíß 6 sendok air. Berapa rasio tepung terhadap air?", a: "3:6" },
                { q: "Di dapur, ada ü•ï 5 buah wortel dan üçÖ 10 buah tomat. Berapa rasio wortel terhadap tomat?", a: "5:10" },
                { q: "Koki Cilik memanggang kue. Dia menggunakan üç´ 2 batang cokelat dan ü•õ 4 gelas susu. Berapa rasio cokelat terhadap susu?", a: "2:4" },
                { q: "Untuk membuat puding, Koki Cilik mencampur üçÆ 6 bungkus agar-agar dengan ü•õ 12 gelas air. Berapa rasio agar-agar terhadap air?", a: "6:12" },
                { q: "Koki Cilik membuat teh. Dia menggunakan üçµ 2 kantung teh dan üçØ 4 sendok madu. Berapa rasio teh terhadap madu?", a: "2:4" },
                { q: "Untuk salad buah, ada ü•ù 4 buah kiwi dan üçå 8 buah pisang. Berapa rasio kiwi terhadap pisang?", a: "4:8" },
                { q: "Ada ü•ú 30 gram kacang dan üçá 60 gram kismis. Berapa rasio kacang terhadap kismis?", a: "30:60" },
                { q: "Ada üçã 10 buah lemon dan üçä 20 buah jeruk. Berapa rasio lemon terhadap jeruk?", a: "10:20" },
                { q: "Koki Cilik membuat sosis. Dia mencampur ü•© 80 gram daging dan üçû 40 gram tepung. Berapa rasio daging terhadap tepung?", a: "80:40" }
            ],
            level2: [
                { q: "Untuk membuat adonan, Koki Cilik butuh üçö 10 sendok tepung dan üíß 5 sendok air. Dalam bentuk paling sederhana, berapa rasio tepung terhadap air?", a: "2:1" },
                { q: "Koki Cilik punya üçé 12 apel dan üçä 6 jeruk. Berapa rasio apel terhadap jeruk dalam bentuk paling sederhana?", a: "2:1" },
                { q: "Koki Cilik mencampur üç´ 8 batang cokelat dengan ü•õ 16 gelas susu. Sederhanakan rasio cokelat terhadap susu!", a: "1:2" },
                { q: "Ada ü•ï 15 wortel dan üçÖ 20 tomat. Sederhanakan rasio wortel terhadap tomat!", a: "3:4" },
                { q: "Untuk membuat jus, Koki Cilik memakai üçì 9 buah stroberi dan üçå 6 buah pisang. Sederhanakan rasio stroberi terhadap pisang!", a: "3:2" },
                { q: "Koki Cilik punya ü•ö 4 telur dan üçû 8 lembar roti. Sederhanakan rasio telur terhadap roti!", a: "1:2" },
                { q: "Ada ü•î 10 kentang dan üßÖ 15 bawang. Sederhanakan rasio kentang terhadap bawang!", a: "2:3" },
                { q: "Untuk sup, Koki Cilik butuh üçó 24 gram ayam dan üßÇ 8 gram garam. Sederhanakan rasio ayam terhadap garam!", a: "3:1" },
                { q: "Koki Cilik punya ü•í 18 mentimun dan ü•¨ 24 lembar selada. Sederhanakan rasio mentimun terhadap selada!", a: "3:4" },
                { q: "Ada üçÑ 20 jamur dan üå∂Ô∏è 10 cabai. Sederhanakan rasio jamur terhadap cabai!", a: "2:1" }
            ],
            level3: [
                { q: "Resep sosis menggunakan rasio daging dan tepung üçñ:üçö = 3:2. Jika Koki Cilik menggunakan 12 kg daging, berapa kg tepung yang dibutuhkan?", a: "8" },
                { q: "Rasio stroberi dan apel di keranjang buah adalah üçì:üçé = 1:2. Jika ada 5 stroberi, berapa jumlah apel?", a: "10" },
                { q: "Untuk membuat kue, rasio gula dan tepung adalah üç¨:üçö = 1:3. Jika ada 6 kg gula, berapa kg tepung yang dibutuhkan?", a: "18" },
                { q: "Rasio telur dan susu dalam resep puding adalah ü•ö:ü•õ = 2:5. Jika Koki Cilik menggunakan 10 telur, berapa gelas susu yang dibutuhkan?", a: "25" },
                { q: "Rasio pisang dan kiwi di lemari es adalah üçå:ü•ù = 4:3. Jika ada 12 pisang, berapa jumlah kiwi?", a: "9" },
                { q: "Rasio lemon dan jeruk di keranjang adalah üçã:üçä = 2:3. Jika ada 8 lemon, berapa jumlah jeruk?", a: "12" },
                { q: "Resep sirup menggunakan rasio gula dan air üç¨:üíß = 3:4. Jika Koki Cilik menggunakan 9 sendok gula, berapa sendok air yang dibutuhkan?", a: "12" },
                { q: "Rasio mangga dan jambu adalah ü•≠:ü´ë = 2:3. Jika ada 6 mangga, berapa jumlah jambu?", a: "9" },
                { q: "Rasio cokelat dan kacang adalah üç´:ü•ú = 5:2. Jika ada 15 gram cokelat, berapa gram kacang yang dibutuhkan?", a: "6" },
                { q: "Untuk adonan, rasio tepung dan mentega adalah üçö:üßà = 4:1. Jika Koki Cilik menggunakan 16 gram tepung, berapa gram mentega yang dibutuhkan?", a: "4" }
            ],
            level4: [
                { q: "Koki Cilik membuat 2 porsi jus dengan 10 buah stroberi. Berapa buah stroberi yang dibutuhkan untuk membuat 5 porsi jus?", a: "25" },
                { q: "Dengan 3 kg tepung, Koki Cilik bisa membuat 12 roti. Berapa kg tepung yang dibutuhkan untuk membuat 20 roti?", a: "5" },
                { q: "Koki Cilik membuat 5 kue dengan 15 butir telur. Berapa butir telur yang dibutuhkan untuk membuat 8 kue?", a: "24" },
                { q: "Koki Cilik bisa mencampur 2 liter air dengan 3 kg gula. Berapa kg gula yang dibutuhkan untuk 10 liter air?", a: "15" },
                { q: "Jika 10 gram bubuk cokelat bisa membuat 4 gelas minuman, berapa gram bubuk cokelat yang dibutuhkan untuk 6 gelas minuman?", a: "15" },
                { q: "Sebuah resep membutuhkan 200 ml susu untuk 500 gram tepung. Berapa ml susu yang dibutuhkan untuk 1 kg (1000 gram) tepung?", a: "400" },
                { q: "Jika 4 orang bisa menghabiskan 8 potong pizza, berapa potong pizza yang dibutuhkan untuk 6 orang?", a: "12" },
                { q: "Sebuah mobil mainan membutuhkan 3 baterai untuk berjalan 60 menit. Berapa baterai yang dibutuhkan untuk 100 menit?", a: "5" },
                { q: "Untuk mengecat 2 dinding, Koki Cilik membutuhkan 10 liter cat. Berapa liter cat yang dibutuhkan untuk 5 dinding?", a: "25" },
                { q: "Jika 3 kg beras bisa memberi makan 6 orang, berapa kg beras yang dibutuhkan untuk 10 orang?", a: "5" }
            ],
            level5: [
                { q: "Jika 3 koki bisa membuat kue dalam 4 jam, berapa jam yang dibutuhkan oleh 6 koki untuk membuat kue yang sama?", a: "2" },
                { q: "Untuk memanggang kue, Koki Cilik butuh 2 oven selama 30 menit. Jika dia menggunakan 4 oven, berapa menit waktu yang dibutuhkan?", a: "15" },
                { q: "Jika 5 orang bisa menghabiskan 10 liter air dalam 2 hari, berapa hari air akan habis jika ada 10 orang?", a: "1" },
                { q: "Jika 6 pekerja bisa menyelesaikan proyek dalam 10 hari, berapa hari yang dibutuhkan 5 pekerja untuk menyelesaikan proyek yang sama?", a: "12" },
                { q: "Koki Cilik punya 2 keran yang bisa mengisi tangki dalam 6 jam. Berapa jam waktu yang dibutuhkan jika dia menggunakan 3 keran?", a: "4" },
                { q: "Jika 4 koki bisa menyelesaikan 100 pesanan dalam 2 jam, berapa koki yang dibutuhkan untuk menyelesaikan 100 pesanan dalam 1 jam?", a: "8" },
                { q: "Dengan kecepatan 60 km/jam, Koki Cilik sampai di toko dalam 2 jam. Berapa kecepatan yang dibutuhkan agar sampai dalam 1 jam?", a: "120" },
                { q: "Jika 10 orang bisa menyelesaikan pekerjaan dalam 6 hari, berapa hari yang dibutuhkan oleh 12 orang?", a: "5" },
                { q: "Untuk mencetak 100 buku, 4 mesin bekerja selama 5 jam. Jika 2 mesin yang digunakan, berapa jam waktu yang dibutuhkan?", a: "10" },
                { q: "Jika 12 potong kue bisa dimakan 4 orang, berapa orang yang bisa menghabiskan kue tersebut jika jumlah kuenya hanya 6 potong?", a: "2" }
            ]
        };

        const levels = ["level1", "level2", "level3", "level4", "level5"];
        let currentLevel = 0;
        let currentQuestionIndex = 0;
        let currentScore = 0;
        let levelQuestions = [];
        let totalScore = 0;
        let levelAnswers = [];

        const introScreen = document.getElementById('intro-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const levelInfo = gameScreen.querySelector('.level-info h2');
        const levelDesc = gameScreen.querySelector('.level-info p');
        const scoreDisplay = document.getElementById('score');
        const questionText = document.getElementById('question-text');
        const feedbackText = document.getElementById('feedback-text');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');
        const finalScoreDisplay = document.getElementById('final-score');
        const studentNameInput = document.getElementById('student-name-input');
        const studentNameFinalDisplay = document.getElementById('student-name-final');
        const ratioInputGroup = document.getElementById('ratio-input-group');
        const singleAnswerInput = document.getElementById('single-answer-input');
        const answerInput1 = document.getElementById('answer-input-1');
        const answerInput2 = document.getElementById('answer-input-2');

        const levelDescriptions = {
            level1: "Pengenalan Rasio: Tuliskan perbandingan bahan-bahan yang Koki Cilik gunakan!",
            level2: "Menyederhanakan Rasio: Sederhanakan perbandingan bahan-bahan resep ini!",
            level3: "Menghitung Jumlah Sebenarnya: Berdasarkan rasio, cari tahu berapa banyak bahan yang Koki Cilik butuhkan!",
            level4: "Perbandingan Senilai: Jika takaran resep bertambah, berapa banyak bahan yang dibutuhkan?",
            level5: "Perbandingan Berbalik Nilai: Jika jumlah koki bertambah, berapa waktu yang dibutuhkan?"
        };

        function startGame() {
            studentName = studentNameInput.value.trim();
            if (studentName) {
                introScreen.style.display = 'none';
                gameScreen.style.display = 'block';
                loadLevel();
            } else {
                alert("Masukkan nama kamu terlebih dahulu!");
            }
        }

        function loadLevel() {
            if (currentLevel >= levels.length) {
                showEndScreen();
                return;
            }
            currentScore = 0;
            currentQuestionIndex = 0;
            scoreDisplay.textContent = currentScore;
            const levelKey = levels[currentLevel];
            levelInfo.textContent = `Level ${currentLevel + 1}`;
            levelDesc.textContent = levelDescriptions[levelKey];
            levelQuestions = shuffleArray(questions[levelKey]).slice(0, 4);
            
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= levelQuestions.length) {
                endLevel();
                return;
            }
            const q = levelQuestions[currentQuestionIndex];
            questionText.textContent = q.q;
            feedbackText.textContent = '';
            submitBtn.style.display = 'inline-block';
            nextBtn.style.display = 'none';
            
            // Tambahkan data soal ke array jawaban
            levelAnswers.push({ question: q.q, answer: null, status: null });

            // Show/hide input fields based on level
            if (currentLevel === 0 || currentLevel === 1) { // Levels with ratio input
                ratioInputGroup.style.display = 'flex';
                singleAnswerInput.style.display = 'none';
                answerInput1.value = '';
                answerInput2.value = '';
                answerInput1.disabled = false;
                answerInput2.disabled = false;
            } else { // Levels with single number input
                ratioInputGroup.style.display = 'none';
                singleAnswerInput.style.display = 'inline-block';
                singleAnswerInput.value = '';
                singleAnswerInput.disabled = false;
            }
        }

        function checkAnswer() {
            let userAnswer = '';
            const currentAnswerData = levelAnswers[currentQuestionIndex];
            const correctAnswer = levelQuestions[currentQuestionIndex].a;
            let isCorrect = false;

            if (currentLevel === 0 || currentLevel === 1) {
                userAnswer = `${answerInput1.value.trim()}:${answerInput2.value.trim()}`;
            } else {
                userAnswer = singleAnswerInput.value.trim();
            }
            
            currentAnswerData.answer = userAnswer;

            if (currentLevel === 0) { // Level 1 - Flexible Answers
                const userParts = userAnswer.split(':');
                const correctParts = correctAnswer.split(':');
                if (userParts.length === 2 && correctParts.length === 2) {
                    const userRatio = parseFloat(userParts[0]) / parseFloat(userParts[1]);
                    const correctRatio = parseFloat(correctParts[0]) / parseFloat(correctParts[1]);
                    if (!isNaN(userRatio) && userRatio.toFixed(2) === correctRatio.toFixed(2)) {
                        isCorrect = true;
                    }
                }
            } else { // Other levels - Strict Answers
                if (userAnswer === correctAnswer) {
                    isCorrect = true;
                }
            }

            if (isCorrect) {
                currentScore += 25;
                scoreDisplay.textContent = currentScore;
                feedbackText.textContent = "Jawaban benar! üéâ";
                feedbackText.className = 'feedback correct';
                currentAnswerData.status = 'Benar';
            } else {
                feedbackText.textContent = "Jawaban salah.";
                feedbackText.className = 'feedback incorrect';
                currentAnswerData.status = 'Salah';
            }

            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
            if (currentLevel === 0 || currentLevel === 1) {
                answerInput1.disabled = true;
                answerInput2.disabled = true;
            } else {
                singleAnswerInput.disabled = true;
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function endLevel() {
            totalScore += currentScore;
            
            // Kirim data untuk setiap soal di level ini ke Google Sheets
            levelAnswers.forEach(data => {
                sendDataToSheet(data.question, data.answer, data.status);
            });
            levelAnswers = []; // Reset array untuk level selanjutnya

            currentLevel++;
            if (currentLevel < levels.length) {
                alert(`Level ${currentLevel} Selesai! Skor Level Ini: ${currentScore}. Lanjut ke Level ${currentLevel + 1}!`);
                loadLevel();
            } else {
                showEndScreen();
            }
        }

        function showEndScreen() {
            gameScreen.style.display = 'none';
            endScreen.style.display = 'block';
            studentNameFinalDisplay.textContent = studentName;
            finalScoreDisplay.textContent = totalScore;
        }

        function resetGame() {
            endScreen.style.display = 'none';
            introScreen.style.display = 'block';
            studentNameInput.value = '';
            totalScore = 0;
            currentLevel = 0;
            currentQuestionIndex = 0;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        async function sendDataToSheet(question, answer, status) {
            const formData = new FormData();
            formData.append('nama', studentName);
            formData.append('level', `Level ${currentLevel + 1}`);
            formData.append('skor', currentScore);
            formData.append('jawaban', `${question} | Jawaban Siswa: ${answer}`);
            formData.append('status', status);
            
            try {
                // Perhatikan bahwa mode 'no-cors' tidak lagi diperlukan jika di-host di GitHub Pages
                await fetch(WEB_APP_URL, {
                    method: 'POST',
                    body: formData
                });
            } catch(error) {
                console.error('Error saat mengirim data:', error);
            }
        }
    </script>
</body>
</html>
